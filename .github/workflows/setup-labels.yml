name: ğŸ·ï¸ Setup Labels

on:
  workflow_dispatch:
  push:
    branches: [main, develop]
    paths:
      - '.github/workflows/setup-labels.yml'

jobs:
  setup-labels:
    runs-on: ubuntu-latest
    permissions:
      issues: write

    steps:
      - name: ğŸ“¥ Checkout
        uses: actions/checkout@v4

      - name: ğŸ·ï¸ ë¼ë²¨ ìƒì„±
        uses: actions/github-script@v7
        with:
          script: |
            const labels = [
              { name: 'ğŸ› bug', color: 'd73a49', description: 'ë²„ê·¸ ìˆ˜ì •' },
              { name: 'âœ¨ feature', color: '2da44e', description: 'ìƒˆë¡œìš´ ê¸°ëŠ¥' },
              { name: 'â™»ï¸ refactor', color: '0366d6', description: 'ì½”ë“œ ë¦¬íŒ©í† ë§' },
              { name: 'ğŸ“š Documentation', color: '6f42c1', description: 'ë¬¸ì„œ ìˆ˜ì •' },
              { name: 'ğŸ§¹ chore', color: 'ffc107', description: 'ì¼ìƒì ì¸ ìœ ì§€ë³´ìˆ˜' },
              { name: 'ğŸ’… style', color: 'fbca04', description: 'ì½”ë“œ ìŠ¤íƒ€ì¼ ë° í¬ë§¤íŒ…' },
              { name: 'âš¡ performance', color: 'ff6600', description: 'ì„±ëŠ¥ ê°œì„ ' },
              { name: 'ğŸ¨ UI', color: 'e00ff7', description: 'UI/UX ê´€ë ¨' },
              { name: 'âš™ï¸ ViewModel', color: '1f6feb', description: 'ViewModel ê´€ë ¨' },
              { name: 'ğŸ“¦ Domain', color: '1f6feb', description: 'Domain ë ˆì´ì–´ ê´€ë ¨' },
              { name: 'ğŸ—„ï¸ Repository', color: '1f6feb', description: 'Repository ê´€ë ¨' },
              { name: 'ğŸ› ï¸ Utility', color: '1f6feb', description: 'Utility í•¨ìˆ˜/í´ë˜ìŠ¤' },
              { name: 'âœ… Test', color: '0075ca', description: 'í…ŒìŠ¤íŠ¸ ê´€ë ¨' },
              { name: 'ğŸ”§ build', color: 'a2eeef', description: 'ë¹Œë“œ ì„¤ì •' },
              { name: 'ğŸ”„ CI/CD', color: 'a2eeef', description: 'CI/CD íŒŒì´í”„ë¼ì¸' },
              { name: 'ğŸš€ ready', color: '7cb342', description: 'ë³‘í•© ì¤€ë¹„ ì™„ë£Œ' },
              { name: 'â¸ï¸ on-hold', color: 'd4a5a5', description: 'ì§„í–‰ ë³´ë¥˜ ì¤‘' },
            ];

            for (const label of labels) {
              try {
                await github.rest.issues.createLabel({
                  owner: context.repo.owner,
                  repo: context.repo.repo,
                  name: label.name,
                  color: label.color,
                  description: label.description,
                });
                console.log(`âœ… Created label: ${label.name}`);
              } catch (error) {
                if (error.status === 422) {
                  console.log(`âš ï¸ Label already exists: ${label.name}`);
                  // ê¸°ì¡´ ë¼ë²¨ ì—…ë°ì´íŠ¸
                  try {
                    await github.rest.issues.updateLabel({
                      owner: context.repo.owner,
                      repo: context.repo.repo,
                      name: label.name,
                      color: label.color,
                      description: label.description,
                    });
                    console.log(`ğŸ”„ Updated label: ${label.name}`);
                  } catch (updateError) {
                    console.error(`âŒ Failed to update label ${label.name}:`, updateError.message);
                  }
                } else {
                  console.error(`âŒ Failed to create label ${label.name}:`, error.message);
                }
              }
            }
            console.log('\nâœ¨ Label setup completed!');

